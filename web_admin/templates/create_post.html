{% extends "base.html" %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}
{% block page_title %}–°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-plus me-2"></i>
                    –ù–æ–≤—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Å—Ç
                </h5>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="title" class="form-label">
                            <i class="fas fa-heading me-1"></i>
                            –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞ *
                        </label>
                        <input type="text" class="form-control" id="title" name="title" 
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!" 
                               value="{{ request.args.get('template_title', '') }}" required>
                    </div>
                    
                    <div class="mb-4">
                        <label for="content" class="form-label">
                            <i class="fas fa-align-left me-1"></i>
                            –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ *
                        </label>
                        <textarea class="form-control" id="content" name="content" rows="6" 
                                  placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞..." required>{{ request.args.get('template_content', '') }}</textarea>
                        <div class="form-text">
                            –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è HTML —Ä–∞–∑–º–µ—Ç–∫–∞: <b>–∂–∏—Ä–Ω—ã–π</b>, <i>–∫—É—Ä—Å–∏–≤</i>, —ç–º–æ–¥–∑–∏ üòä
                        </div>
                    </div>
                    
                    <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–∞ -->
                    <div class="mb-4">
                        <label class="form-label">
                            <i class="fas fa-image me-1"></i>
                            –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–∞
                        </label>
                        
                        <ul class="nav nav-tabs" id="imageTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="url-tab" data-bs-toggle="tab" 
                                        data-bs-target="#url-pane" type="button" role="tab">
                                    <i class="fas fa-link me-1"></i>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="upload-tab" data-bs-toggle="tab" 
                                        data-bs-target="#upload-pane" type="button" role="tab">
                                    <i class="fas fa-upload me-1"></i>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                                </button>
                            </li>
                        </ul>
                        
                        <div class="tab-content border border-top-0 p-3">
                            <div class="tab-pane fade show active" id="url-pane" role="tabpanel">
                                <input type="url" class="form-control" id="image_url" name="image_url" 
                                       placeholder="https://images.pexels.com/photos/..." 
                                       onchange="previewUrlImage(this)">
                                <div class="form-text">
                                    –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å Pexels –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
                                </div>
                            </div>
                            <div class="tab-pane fade" id="upload-pane" role="tabpanel">
                                <input type="file" class="form-control" id="image_file" name="image_file" 
                                       accept="image/*" onchange="previewUploadedImage(this)">
                                <div class="form-text">
                                    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: JPG, PNG, GIF, WebP (–º–∞–∫—Å. 16MB)
                                </div>
                            </div>
                        </div>
                        
                        <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                        <div id="image-preview" class="mt-3" style="display: none;">
                            <img id="preview-img" class="post-preview-image" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
                        </div>
                    </div>
                    
                    <!-- –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                    <div class="mb-4">
                        <label class="form-label">
                            <i class="fas fa-clock me-1"></i>
                            –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
                        </label>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <i class="fas fa-sun text-warning fa-2x mb-2"></i>
                                        <h6>–£—Ç—Ä–æ–º</h6>
                                        <div class="form-check form-switch d-flex justify-content-center">
                                            <input class="form-check-input" type="checkbox" id="morning_enabled" 
                                                   name="morning_enabled" onchange="toggleTimeSelection('morning')">
                                        </div>
                                        <select class="form-select form-select-sm mt-2" id="morning_time" name="morning_time" disabled>
                                            <option value="07:00">07:00</option>
                                            <option value="08:00">08:00</option>
                                            <option value="09:00" selected>09:00</option>
                                            <option value="10:00">10:00</option>
                                            <option value="11:00">11:00</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <i class="fas fa-sun text-info fa-2x mb-2"></i>
                                        <h6>–î–Ω–µ–º</h6>
                                        <div class="form-check form-switch d-flex justify-content-center">
                                            <input class="form-check-input" type="checkbox" id="afternoon_enabled" 
                                                   name="afternoon_enabled" onchange="toggleTimeSelection('afternoon')">
                                        </div>
                                        <select class="form-select form-select-sm mt-2" id="afternoon_time" name="afternoon_time" disabled>
                                            <option value="12:00">12:00</option>
                                            <option value="13:00">13:00</option>
                                            <option value="14:00" selected>14:00</option>
                                            <option value="15:00">15:00</option>
                                            <option value="16:00">16:00</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <i class="fas fa-moon text-primary fa-2x mb-2"></i>
                                        <h6>–í–µ—á–µ—Ä–æ–º</h6>
                                        <div class="form-check form-switch d-flex justify-content-center">
                                            <input class="form-check-input" type="checkbox" id="evening_enabled" 
                                                   name="evening_enabled" onchange="toggleTimeSelection('evening')">
                                        </div>
                                        <select class="form-select form-select-sm mt-2" id="evening_time" name="evening_time" disabled>
                                            <option value="17:00">17:00</option>
                                            <option value="18:00">18:00</option>
                                            <option value="19:00" selected>19:00</option>
                                            <option value="20:00">20:00</option>
                                            <option value="21:00">21:00</option>
                                            <option value="22:00">22:00</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="target_audience" class="form-label">
                            <i class="fas fa-users me-1"></i>
                            –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
                        </label>
                        <select class="form-select" id="target_audience" name="target_audience">
                            <option value="channel">üì¢ –ö–∞–Ω–∞–ª (–ø—É–±–ª–∏—á–Ω–∞—è –ª–µ–Ω—Ç–∞)</option>
                            <option value="all">üë• –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã</option>
                            <option value="active">üî• –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (–ø–æ–∫—É–ø–∞–ª–∏ –∑–∞ –º–µ—Å—è—Ü)</option>
                            <option value="vip">üíé VIP –∫–ª–∏–µ–Ω—Ç—ã (–ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ $500+)</option>
                            <option value="new">üÜï –ù–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∑–∞ –Ω–µ–¥–µ–ª—é)</option>
                        </select>
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            <strong>–ö–∞–Ω–∞–ª:</strong> -1002566537425 (–ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ—Å—Ç—ã)
                            <br><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è:</strong> –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–∞–∑–∞, —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–∞–π—Ç, –æ—Ç–∑—ã–≤—ã —Ç–æ–≤–∞—Ä–æ–≤
                        </div>
                    </div>
                    
                    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–Ω–æ–ø–æ–∫ -->
                    <div class="mb-4">
                        <label class="form-label">
                            <i class="fas fa-mouse-pointer me-1"></i>
                            –ö–Ω–æ–ø–∫–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º
                        </label>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <label for="bot_username" class="form-label">Username –±–æ—Ç–∞</label>
                                <input type="text" class="form-control" id="bot_username" name="bot_username" 
                                       placeholder="Safar_call_bot" value="Safar_call_bot">
                            </div>
                            <div class="col-md-6">
                                <label for="website_url" class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ —Å–∞–π—Ç</label>
                                <input type="url" class="form-control" id="website_url" name="website_url" 
                                       placeholder="https://your-website.com" value="https://your-website.com">
                            </div>
                        </div>
                        
                        <div class="form-check mt-2">
                            <input class="form-check-input" type="checkbox" id="include_reviews" name="include_reviews" checked>
                            <label class="form-check-label" for="include_reviews">
                                –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤—ã –æ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö
                            </label>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save me-2"></i>
                            –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç
                        </button>
                        <a href="{{ url_for('scheduled_posts') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>
                            –û—Ç–º–µ–Ω–∞
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-eye me-2"></i>
                    –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                </h5>
            </div>
            <div class="card-body">
                <div class="border rounded p-3" style="background-color: #f8f9fa;">
                    <div id="preview-content">
                        <div class="text-muted text-center">
                            <i class="fas fa-mobile-alt fa-2x mb-2"></i>
                            <p>–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-3">
                    <h6>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏:</h6>
                    <div id="schedule-preview">
                        <small class="text-muted">–í–∫–ª—é—á–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã -->
        <div class="card mt-3">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-magic me-1"></i>
                    –ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã
                </h6>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="fillTemplate('morning')">
                        üåÖ –£—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
                    </button>
                    <button type="button" class="btn btn-outline-warning btn-sm" onclick="fillTemplate('promotion')">
                        üéÅ –ê–∫—Ü–∏—è –¥–Ω—è
                    </button>
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="fillTemplate('evening')">
                        üåô –í–µ—á–µ—Ä–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                    </button>
                    <button type="button" class="btn btn-outline-success btn-sm" onclick="fillTemplate('new_product')">
                        üÜï –ù–æ–≤–∏–Ω–∫–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
function toggleTimeSelection(period) {
    const checkbox = document.getElementById(`${period}_enabled`);
    const select = document.getElementById(`${period}_time`);
    
    select.disabled = !checkbox.checked;
    if (!checkbox.checked) {
        select.value = '';
    }
    
    updateSchedulePreview();
}

// –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
function previewUploadedImage(input) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('preview-img').src = e.target.result;
            document.getElementById('image-preview').style.display = 'block';
            updatePreview();
        };
        reader.readAsDataURL(file);
    }
}

// –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ URL
function previewUrlImage(input) {
    const url = input.value;
    if (url) {
        document.getElementById('preview-img').src = url;
        document.getElementById('image-preview').style.display = 'block';
        updatePreview();
    } else {
        document.getElementById('image-preview').style.display = 'none';
        updatePreview();
    }
}

// –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å—Ç–∞
function updatePreview() {
    const title = document.getElementById('title').value;
    const content = document.getElementById('content').value;
    const imageUrl = document.getElementById('image_url').value || 
                    (document.getElementById('preview-img').src !== window.location.href ? 
                     document.getElementById('preview-img').src : '');
    const previewDiv = document.getElementById('preview-content');
    
    if (title || content || imageUrl) {
        let preview = '<div class="telegram-message">';
        
        if (imageUrl) {
            preview += `<img src="${imageUrl}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞" class="img-fluid rounded mb-2" style="max-height: 200px; width: 100%; object-fit: cover;">`;
        }
        
        if (title) {
            preview += `<div class="fw-bold mb-2">üì¢ <b>${title}</b></div>`;
        }
        if (content) {
            preview += `<div class="mb-2">${content.replace(/\n/g, '<br>')}</div>`;
        }
        preview += '<div class="mt-2 small text-muted">üõç –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥: /start</div>';
        preview += '</div>';
        
        previewDiv.innerHTML = preview;
    } else {
        previewDiv.innerHTML = '<div class="text-muted text-center"><i class="fas fa-mobile-alt fa-2x mb-2"></i><p>–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</p></div>';
    }
}

// –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
function updateSchedulePreview() {
    const scheduleDiv = document.getElementById('schedule-preview');
    let schedule = '';
    
    if (document.getElementById('morning_enabled').checked) {
        const time = document.getElementById('morning_time').value;
        schedule += `<div class="mb-1"><i class="fas fa-sun text-warning me-1"></i> –£—Ç—Ä–æ–º –≤ ${time}</div>`;
    }
    if (document.getElementById('afternoon_enabled').checked) {
        const time = document.getElementById('afternoon_time').value;
        schedule += `<div class="mb-1"><i class="fas fa-sun text-info me-1"></i> –î–Ω–µ–º –≤ ${time}</div>`;
    }
    if (document.getElementById('evening_enabled').checked) {
        const time = document.getElementById('evening_time').value;
        schedule += `<div class="mb-1"><i class="fas fa-moon text-primary me-1"></i> –í–µ—á–µ—Ä–æ–º –≤ ${time}</div>`;
    }
    
    if (schedule) {
        scheduleDiv.innerHTML = schedule;
    } else {
        scheduleDiv.innerHTML = '<small class="text-muted">–í–∫–ª—é—á–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</small>';
    }
}

// –®–∞–±–ª–æ–Ω—ã –ø–æ—Å—Ç–æ–≤
function fillTemplate(type) {
    const templates = {
        'morning': {
            title: '–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!',
            content: 'üåÖ –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, –¥–æ—Ä–æ–≥–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏!\n\n–ù–∞—á–Ω–∏—Ç–µ –¥–µ–Ω—å —Å –≤—ã–≥–æ–¥–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –≤ –Ω–∞—à–µ–º –º–∞–≥–∞–∑–∏–Ω–µ!\n\nüõç –ù–æ–≤–∏–Ω–∫–∏ –∏ –∞–∫—Ü–∏–∏ –∂–¥—É—Ç –≤–∞—Å!',
            image: 'https://images.pexels.com/photos/1002703/pexels-photo-1002703.jpeg'
        },
        'promotion': {
            title: '–ì–æ—Ä—è—á–∞—è –∞–∫—Ü–∏—è!',
            content: 'üî• –ì–û–†–Ø–ß–ê–Ø –ê–ö–¶–ò–Ø –î–ù–Ø!\n\nüéÅ –°–∫–∏–¥–∫–∏ –¥–æ 50% –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã!\n‚è∞ –¢–æ–ª—å–∫–æ –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è!\n\nüí∞ –ù–µ —É–ø—É—Å—Ç–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å!',
            image: 'https://images.pexels.com/photos/1303081/pexels-photo-1303081.jpeg'
        },
        'evening': {
            title: '–í–µ—á–µ—Ä–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏',
            content: 'üåÜ –î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä!\n\nüí° –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å –ø–æ–¥–æ–±—Ä–∞–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã!\n\nüõí –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑ —Å–µ–≥–æ–¥–Ω—è –∏ –ø–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É!',
            image: 'https://images.pexels.com/photos/230544/pexels-photo-230544.jpeg'
        },
        'new_product': {
            title: '–ù–æ–≤–∏–Ω–∫–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ!',
            content: 'üÜï –ù–û–í–ò–ù–ö–ê –í –ù–ê–®–ï–ú –ö–ê–¢–ê–õ–û–ì–ï!\n\n‚ú® –í—Å—Ç—Ä–µ—á–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä!\nüíé –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ –¥–æ—Å—Ç—É–ø–Ω–æ–π —Ü–µ–Ω–µ!\n\nüõç –ó–∞–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø–µ—Ä–≤—ã–º–∏!',
            image: 'https://images.pexels.com/photos/1464625/pexels-photo-1464625.jpeg'
        }
    };
    
    const template = templates[type];
    if (template) {
        document.getElementById('title').value = template.title;
        document.getElementById('content').value = template.content;
        document.getElementById('image_url').value = template.image;
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É URL –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
        document.getElementById('url-tab').click();
        previewUrlImage(document.getElementById('image_url'));
        
        updatePreview();
    }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
document.getElementById('title').addEventListener('input', updatePreview);
document.getElementById('content').addEventListener('input', updatePreview);

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
updatePreview();
updateSchedulePreview();
</script>

<style>
.telegram-message {
    background: white;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.card {
    transition: all 0.3s ease;
}

.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.form-check-input:checked {
    background-color: #667eea;
    border-color: #667eea;
}
</style>
{% endblock %}